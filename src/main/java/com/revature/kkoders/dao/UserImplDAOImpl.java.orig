package com.revature.kkoders.dao;

import com.revature.kkoders.hibernateUtil.HibernateUtil;
import com.revature.kkoders.beans.UserImpl;

import java.util.ArrayList;
import java.util.List;

import org.hibernate.Criteria;
import org.hibernate.Query;
import org.hibernate.Session;
import org.hibernate.Transaction;
import org.hibernate.criterion.Restrictions;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Component;

@Component
public class UserImplDAOImpl implements UserImplDAO {

	@Autowired
	UserImpl newUser;
  
	public UserImpl getUserById(int userID) {
		Session session = HibernateUtil.getSession();
<<<<<<< HEAD

||||||| merged common ancestors
<<<<<<<<< Temporary merge branch 1
=======

		UserImpl user = (UserImpl) session.get(UserImpl.class, userID);

		session.close();
		return user;
  /*
>>>>>>> eb8dafab90e8e1701b0df1bd18b3cee7bbd8d35b
		String hql = "from UserImpl where userID =:uid";
		Query query = session.createQuery(hql);
		
		query.setParameter("uid", userID);
		UserImpl x = (UserImpl) query.list().get(0);
		//UserImpl user = (UserImpl) session.get(UserImpl.class, userID);
		
		session.close();
		return x;
<<<<<<< HEAD
		
||||||| merged common ancestors
		
		
||||||||| merged common ancestors
		return user;
		
		
=========
		return user;

>>>>>>>>> Temporary merge branch 2
=======
		*/
>>>>>>> eb8dafab90e8e1701b0df1bd18b3cee7bbd8d35b
	}

	public void UpdatePasswordByUn(String password, String n) {
		Session session = HibernateUtil.getSession();
		String hql = "UPDATE UserImpl SET pw  =:pw where userName =:userName";
		Query query = session.createQuery(hql);

		Transaction t = session.beginTransaction();

		query.setParameter("pw", password);
		query.setParameter("userName", n);
		query.executeUpdate();

		t.commit();
		session.close();

	}

	public void UpdateEmailByUn(String email, String n) {
		Session session = HibernateUtil.getSession();
		String hql = "UPDATE UserImpl SET email =:email where userName =:userName";
		Query query = session.createQuery(hql);

		Transaction t = session.beginTransaction();

		query.setParameter("email", email);
		query.setParameter("userName", n);
		query.executeUpdate();

		t.commit();
		session.close();

	}

	public void UpdateDescriptionByUn(String descrip, String n) {
		Session session = HibernateUtil.getSession();
		String hql = "UPDATE UserImpl SET desc =:desc where userName =:userName";
		Query query = session.createQuery(hql);

		Transaction t = session.beginTransaction();

		query.setParameter("desc", descrip);
		query.setParameter("userName", n);
		query.executeUpdate();

		t.commit();
		session.close();

	}

	public void UpdatePictureByUn(String URL, String n) {
		Session session = HibernateUtil.getSession();
		String hql = "UPDATE UserImpl SET picURL =:picURL where userName =:userName";
		Query query = session.createQuery(hql);

		Transaction t = session.beginTransaction();

		query.setParameter("picURl", URL);
		query.setParameter("userName", n);
		query.executeUpdate();

		t.commit();
		session.close();

	}

	@Override
	public void SignUpUser(String fn, String ln, String un, String p, String em, String picurl, String d) {
		Session session = HibernateUtil.getSession();
		Transaction t = session.beginTransaction();
<<<<<<< HEAD
		UserImpl newUser = new UserImpl();
||||||| merged common ancestors
<<<<<<<<< Temporary merge branch 1
		
||||||||| merged common ancestors
		
		UserImpl newUser = new UserImpl();
=========
=======

>>>>>>> eb8dafab90e8e1701b0df1bd18b3cee7bbd8d35b

<<<<<<< HEAD
||||||| merged common ancestors
		UserImpl newUser = new UserImpl();
>>>>>>>>> Temporary merge branch 2
=======
		UserImpl newUser = new UserImpl();

		

>>>>>>> eb8dafab90e8e1701b0df1bd18b3cee7bbd8d35b
		newUser.setFirstName(fn);
		newUser.setLastName(ln);
		newUser.setUserName(un);
		newUser.setPw(p);
		newUser.setEmail(em);
		newUser.setPicture(picurl);
		newUser.setDesc(d);

		session.save(newUser);
		session.getTransaction();
		t.commit();
<<<<<<< HEAD
||||||| merged common ancestors
<<<<<<<<< Temporary merge branch 1
		session.close();
		
		
||||||||| merged common ancestors
		
		
=========

>>>>>>>>> Temporary merge branch 2
=======


	}

	public UserImpl getUserByUserName(String username) {

		Session session = HibernateUtil.getSession();

		List<UserImpl> user = session.createCriteria(UserImpl.class).add(Restrictions.eq("userName", username)).list();

		session.close();
		
		return user.get(0);
	}
	
	public void updateUser(UserImpl updatedUser){
		Session session = HibernateUtil.getSession();
		Transaction t = session.beginTransaction();

		session.update(updatedUser);
		//session.getTransaction();
    session.close();
		t.commit();
>>>>>>> eb8dafab90e8e1701b0df1bd18b3cee7bbd8d35b
	}

<<<<<<< HEAD
	public UserImpl getUserByUserName(String username) {

||||||| merged common ancestors
<<<<<<<<< Temporary merge branch 1
	/*
	@Override
	public String getUserByUserName(String newname) {
||||||||| merged common ancestors
	@Override
	public String getUserByUserName(String newname) {
=========
	public UserImpl getUserByUserName(String username) {

>>>>>>>>> Temporary merge branch 2
=======

	/*
	@Override
	public String getUserByUserName(String newname) {
>>>>>>> eb8dafab90e8e1701b0df1bd18b3cee7bbd8d35b
		Session session = HibernateUtil.getSession();
<<<<<<< HEAD

		List<UserImpl> user = session.createCriteria(UserImpl.class).add(Restrictions.eq("userName", username)).list();

||||||| merged common ancestors
<<<<<<<<< Temporary merge branch 1
		Criteria cr = session.createCriteria(UserImpl.class);
		cr.add(Restrictions.eq("userName", newname));
		String x = ( (UserImpl) cr.list().get(0)).getUserName();
		
||||||||| merged common ancestors
		UserImpl user = (UserImpl) session.get(UserImpl.class, newname);
		
=========

		List<UserImpl> user = session.createCriteria(UserImpl.class).add(Restrictions.eq("userName", username)).list();

>>>>>>>>> Temporary merge branch 2
=======
		Criteria cr = session.createCriteria(UserImpl.class);
		cr.add(Restrictions.eq("userName", newname));
		String x = ( (UserImpl) cr.list().get(0)).getUserName();
		
>>>>>>> eb8dafab90e8e1701b0df1bd18b3cee7bbd8d35b
		session.close();
<<<<<<< HEAD
		
		return user.get(0);
||||||| merged common ancestors
<<<<<<<<< Temporary merge branch 1
		return  x;
	}

	//This method will get ALL INFO of the user by the user name
	@Override
	public UserImpl getUsersInfoByUsername(String un) {
		 
		UserImpl x  =null;
		Session session = HibernateUtil.getSession();
		String hql = "from UserImpl where userName =:userName";
		Query query = session.createQuery(hql);
		
		
		
		query.setParameter("userName", un);
		
		x = (UserImpl) query.list().get(0);
		
		session.close();
		return x;
		
		
		
||||||||| merged common ancestors
		return user.toString();
=========
		
		return user.get(0);
>>>>>>>>> Temporary merge branch 2
=======
		return  x;
	}

	//This method will get ALL INFO of the user by the user name
	@Override
	public UserImpl getUsersInfoByUsername(String un) {
		 
		UserImpl x  =null;
		Session session = HibernateUtil.getSession();
		String hql = "from UserImpl where userName =:userName";
		Query query = session.createQuery(hql);
		
		
		
		query.setParameter("userName", un);
		
		x = (UserImpl) query.list().get(0);
		
		session.close();
		return x;
		
		
		
>>>>>>> eb8dafab90e8e1701b0df1bd18b3cee7bbd8d35b
	}
<<<<<<< HEAD
	
	public void updateUser(UserImpl updatedUser){
		Session session = HibernateUtil.getSession();
		Transaction t = session.beginTransaction();
||||||| merged common ancestors
<<<<<<<<< Temporary merge branch 1

	*/
||||||||| merged common ancestors

	
=========
	
	public void updateUser(UserImpl updatedUser){
		Session session = HibernateUtil.getSession();
		Transaction t = session.beginTransaction();
=======

	*/
>>>>>>> eb8dafab90e8e1701b0df1bd18b3cee7bbd8d35b

<<<<<<< HEAD
		System.out.println(updatedUser);
		session.update(updatedUser);
		
		session.flush();
    	session.close();
		t.commit();
	}
||||||| merged common ancestors
		session.update(updatedUser);
		//session.getTransaction();
		t.commit();
	}
>>>>>>>>> Temporary merge branch 2

=======

>>>>>>> eb8dafab90e8e1701b0df1bd18b3cee7bbd8d35b
}
